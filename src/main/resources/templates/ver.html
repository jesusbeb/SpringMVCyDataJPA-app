<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="layout/layout :: head"></head>

<header th:replace="layout/layout :: header"></header>

<div class="container py-4">

	<!--Vista de detalle para mostrar la imagen del cliente-->
	<div class="card bg-light">
		<div class="card-header" th:text="${titulo}"></div>
		<div class="card-body">
			
			<!--Link para crear factura-->
			<h4 class="card-title">
				<a class="btn btn-primary btn-xs" th:href="@{'/factura/form/' + ${cliente.id} }" th:text="'crear factura'"></a>
			</h4>

			<!--th:src accede al directorio donde se almacena la imagen, se le concatena el nombre de la imagen que se obtiene a traves del objeto cliente
		    con el atributo if de thymeleaf validamos si existe la foto, usamos la clase helper strings con el metodo length para calcular el largo del 
		    nombre de la foto, si es mayor que cero, existe. Para llamar clases helper usamos #
			-->
			<img th:if="${#strings.length(cliente.foto) > 0}" class="img-thumbnail rounded float-left"
				style="max-width: 25%;" th:src="@{ '/uploads/' + ${cliente.foto} }" th:alt="${cliente.foto}" />

			<!--Al lado de la foto mostramos los datos del cliente en una ul-->
			<ul class="list-group">
				<li class="list-group-item" th:text="${cliente.nombre}"></li>
				<li class="list-group-item" th:text="${cliente.apellido}"></li>
				<li class="list-group-item" th:text="${cliente.email}"></li>
				<li class="list-group-item" th:text="${cliente.createAt}"></li>
			</ul>
			
			<!--Si la lista de facturas esta vacia, se muestra notificacion que no hay facturas-->
			<div th:if="${#lists.isEmpty(cliente.facturas)}" class="alert alert-info my-4" th:text="'No hay facturas asignadas para el cliente ' + ${cliente.nombre} + ' ' + ${cliente.apellido}"></div>

			<!--Si la lista de facturas no esta vasia, muestra la tabla de facturas-->
			<table th:if="${not #lists.isEmpty(cliente.facturas)}" class="table table-bordered table-striped my-4">
				<thead class="thead-dark">
					<tr>
						<th>Folio</th>
						<th>Descripcion</th>
						<th>Fecha</th>
						<th>Total</th>
					</tr>
				</thead>
				<tbody>
					<!--Iteramos las facturas del cliente y mostramos los atributos-->
					<tr th:each="factura: ${cliente.facturas}">
						<td th:text="${factura.id}"></td>
						<td th:text="${factura.descripcion}"></td>
						<td th:text="${factura.createAt}"></td>
						<td th:text="${factura.total}"></td>
					</tr>
				</tbody>

			</table>

		</div>
	</div>
</div>

<footer th:replace="layout/layout :: footer"></footer>

<body>

</body>

</html>